<template>
    <Layout>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 p-6">
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-blue-500 bg-opacity-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-500" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h2 class="font-semibold text-gray-400 text-sm">Total Articles</h2>
                        <p class="font-bold text-2xl text-gray-900">5</p>
                        <p class="text-green-500 text-sm flex items-center mt-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                <polyline points="17 6 23 6 23 12"></polyline>
                            </svg>
                            12% increase
                        </p>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-purple-500 bg-opacity-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-500" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h2 class="font-semibold text-gray-400 text-sm">Total Users</h2>
                        <p class="font-bold text-2xl text-gray-900">12</p>
                        <p class="text-green-500 text-sm flex items-center mt-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                <polyline points="17 6 23 6 23 12"></polyline>
                            </svg>
                            8% increase
                        </p>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-green-500 bg-opacity-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h2 class="font-semibold text-gray-400 text-sm">Comments</h2>
                        <p class="font-bold text-2xl text-gray-900">31</p>
                        <p class="text-green-500 text-sm flex items-center mt-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                <polyline points="17 6 23 6 23 12"></polyline>
                            </svg>
                            24% increase
                        </p>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-yellow-500 bg-opacity-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-500" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h2 class="font-semibold text-gray-400 text-sm">Avg. Time on Site</h2>
                        <p class="font-bold text-2xl text-gray-900">4m 23s</p>
                        <p class="text-red-500 text-sm flex items-center mt-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
                                <polyline points="17 18 23 18 23 12"></polyline>
                            </svg>
                            3% decrease
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 px-6 pb-6">
            <!-- Bar Chart: Article Counts -->
            <div class="bg-white rounded-2xl p-6 flex flex-col">
                <h3 class="text-lg font-semibold text-gray-700 mb-4">Monthly Articles</h3>
                <div class="flex-1 relative h-64">
                    <Chart v-if="barChartData" :chartType="'bar'" :chartData="barChartData"
                        :chartOptions="chartOptions" />
                </div>
            </div>

            <!-- Line Chart: Views -->
            <div class="bg-white rounded-2xl p-6 flex flex-col">
                <h3 class="text-lg font-semibold text-gray-700 mb-4">Monthly Views</h3>
                <div class="flex-1 relative h-64">
                    <Chart v-if="lineChartData" :chartType="'line'" :chartData="lineChartData"
                        :chartOptions="chartOptions" />
                </div>
            </div>
        </div>

    </Layout>
</template>

<script setup>
import { ref, onMounted } from "vue";
import axios from "axios";

import Layout from "../../components/Layout.vue";
import Chart from "../../components/Chart.vue";

// Reactive variables for chart data
const barChartData = ref(null);
const lineChartData = ref(null);
const chartOptions = ref({
    responsive: true,
    maintainAspectRatio: false,
});

const fetchChartData = async () => {
    try {
        const response = await axios.get("/chart-data/articles");

        // Bar Chart Data (Article count per month)
        barChartData.value = {
            labels: response.data.labels,
            datasets: [
                {
                    label: "Articles Created",
                    data: response.data.datasets[0].data,
                    backgroundColor: "rgba(75, 192, 192, 0.6)",
                },
            ],
        };

        // Line Chart Data (View count per month)
        lineChartData.value = {
            labels: response.data.labels,
            datasets: [
                {
                    label: "Total Views",
                    data: response.data.datasets[1].data,
                    borderColor: "rgba(255, 99, 132, 1)",
                    borderWidth: 2,
                    fill: false,
                },
            ],
        };
    } catch (error) {
        console.error("Error fetching chart data:", error);
    }
};

// Fetch data on mounted
onMounted(fetchChartData);
</script>
